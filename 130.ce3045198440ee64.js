(self.webpackChunkshell=self.webpackChunkshell||[]).push([[130],{3540:(L,R,s)=>{s.d(R,{MfeLoaderService:()=>t});var A=s(467),M=s(2485),b=s(1913),d=s(5565);let t=(()=>{class v{constructor(){this.mfeConfigs=[],this.loadedMfesSubject=new M.BehaviorSubject(new Set),this.loadedMfes$=this.loadedMfesSubject.asObservable(),this.loadingMfesSubject=new M.BehaviorSubject(new Set),this.loadingMfes$=this.loadingMfesSubject.asObservable()}setConfigs(l){this.mfeConfigs=l.sort((i,f)=>f.priority-i.priority)}getConfigs(){return this.mfeConfigs}getConfigsForRole(l){return this.mfeConfigs.filter(i=>i.allowedRoles.includes(l))}getConfigByName(l){return this.mfeConfigs.find(i=>i.name===l)}preloadPriorityMfes(l){var i=this;return(0,A.A)(function*(){const y=i.getConfigsForRole(l).filter(S=>S.priority>=5).map(S=>i.loadMfe(S));yield Promise.all(y)})()}loadMfe(l){var i=this;return(0,A.A)(function*(){const f=i.loadingMfesSubject.value,j=i.loadedMfesSubject.value;if(j.has(l.name))console.log(`[MfeLoaderService] MFE ${l.name} already loaded`);else if(f.has(l.name))console.log(`[MfeLoaderService] MFE ${l.name} is already loading`);else try{const y=new Set(f);y.add(l.name),i.loadingMfesSubject.next(y),console.log(`[MfeLoaderService] Loading MFE ${l.name} (priority: ${l.priority})`);const S=yield(0,b.loadRemoteModule)({type:"module",remoteEntry:l.url,exposedModule:l.exposedModule}),O=new Set(j);O.add(l.name),i.loadedMfesSubject.next(O);const P=new Set(f);return P.delete(l.name),i.loadingMfesSubject.next(P),console.log(`[MfeLoaderService] Successfully loaded MFE ${l.name}`),S}catch(y){console.error(`[MfeLoaderService] Error loading MFE ${l.name}:`,y);const S=new Set(f);throw S.delete(l.name),i.loadingMfesSubject.next(S),y}})()}isMfeLoaded(l){return this.loadedMfesSubject.value.has(l)}isMfeLoading(l){return this.loadingMfesSubject.value.has(l)}static{this.\u0275fac=function(i){return new(i||v)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})()},3130:(L,R,s)=>{s.r(R),s.d(R,{bootstrap:()=>Z});var A=s(1194),M=s(467),E=s(3319),b=s(5315),C=s(3793),d=s(2485),D=s(7412),t=s(5565),v=s(1663);let T=(()=>{class o{constructor(e){this.http=e}login(){window.location.href="http://localhost:4000/auth/login"}logout(){window.location.href="http://localhost:4000/auth/logout"}getUserProfile(){return this.http.get("http://localhost:4000/auth/me",{withCredentials:!0})}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(v.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var l=s(8662),i=s(9903);let f=(()=>{class o{constructor(){this.currentUserSubject=new d.BehaviorSubject(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadDummyUser()}loadDummyUser(){const e=sessionStorage.getItem("current_user");e?this.currentUserSubject.next(JSON.parse(e)):this.setCurrentUser({id:"1",name:"John Doe",email:"john.doe@example.com",role:i.g.SALES_EXECUTIVE})}setCurrentUser(e){this.currentUserSubject.next(e),e?sessionStorage.setItem("current_user",JSON.stringify(e)):sessionStorage.removeItem("current_user")}getCurrentUser(){return this.currentUserSubject.value}getCurrentUserRole(){return this.currentUserSubject.value?.role||null}hasRole(e){const n=this.getCurrentUserRole();return!!n&&(0,i.W)(n,e)}canViewOthersData(){const e=this.getCurrentUserRole();return e===i.g.SUPER_ADMIN||e===i.g.ORG_ADMIN||e===i.g.TEAM_LEAD}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),j=(()=>{class o{constructor(){this.salesExecutivesSubject=new d.BehaviorSubject(this.generateSalesExecutives()),this.salesExecutives$=this.salesExecutivesSubject.asObservable(),this.salesRecordsSubject=new d.BehaviorSubject(this.generateSalesRecords()),this.salesRecords$=this.salesRecordsSubject.asObservable(),this.incentiveRulesSubject=new d.BehaviorSubject(this.generateIncentiveRules()),this.incentiveRules$=this.incentiveRulesSubject.asObservable(),this.incentivesEarnedSubject=new d.BehaviorSubject(this.generateIncentivesEarned()),this.incentivesEarned$=this.incentivesEarnedSubject.asObservable()}generateSalesExecutives(){return[{id:"1",name:"John Doe",email:"john.doe@example.com",teamId:"team1"},{id:"2",name:"Jane Smith",email:"jane.smith@example.com",teamId:"team1"},{id:"3",name:"Bob Johnson",email:"bob.johnson@example.com",teamId:"team2"},{id:"4",name:"Alice Williams",email:"alice.williams@example.com",teamId:"team2"},{id:"5",name:"Charlie Brown",email:"charlie.brown@example.com",teamId:"team1"}]}generateSalesRecords(){const e=[],n=this.generateSalesExecutives(),r=["Product A","Product B","Product C","Product D"],c=["completed","pending","cancelled"];for(let a=0;a<50;a++){const h=n[a%n.length],p=Math.floor(a/10),u=new Date;u.setMonth(u.getMonth()-p),e.push({id:`sale-${a+1}`,salesExecutiveId:h.id,salesExecutiveName:h.name,date:u,productName:r[a%r.length],amount:Math.floor(5e4*Math.random())+1e4,quantity:Math.floor(10*Math.random())+1,status:c[a%3]})}return e}generateIncentiveRules(){return[{id:"rule-1",name:"Basic Sales Incentive",description:"5% incentive on all sales",type:"percentage",value:5,isActive:!0,createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"rule-2",name:"High Value Sales Bonus",description:"10% incentive on sales above $50,000",type:"percentage",value:10,minSalesAmount:5e4,isActive:!0,createdBy:"admin",createdAt:new Date("2024-02-01")},{id:"rule-3",name:"Product A Special",description:"Fixed $500 bonus for Product A sales",type:"fixed",value:500,productCategory:"Product A",isActive:!0,createdBy:"team-lead-1",createdAt:new Date("2024-03-01")},{id:"rule-4",name:"Tiered Volume Incentive",description:"15% incentive on sales above $100,000",type:"tiered",value:15,minSalesAmount:1e5,isActive:!1,createdBy:"admin",createdAt:new Date("2024-04-01")}]}generateIncentivesEarned(){const e=[],n=this.generateSalesExecutives(),r=this.generateIncentiveRules(),c=["pending","approved","paid"];for(let a=0;a<30;a++){const h=n[a%n.length],p=r[a%r.length],u=Math.floor(a/10),m=new Date;m.setMonth(m.getMonth()-u),e.push({id:`incentive-${a+1}`,salesExecutiveId:h.id,salesExecutiveName:h.name,ruleId:p.id,ruleName:p.name,salesRecordId:`sale-${a+1}`,amount:Math.floor(5e3*Math.random())+500,earnedDate:m,status:c[a%3]})}return e}getSalesRecordsForExecutive(e){return this.salesRecordsSubject.value.filter(n=>n.salesExecutiveId===e)}getIncentivesForExecutive(e){return this.incentivesEarnedSubject.value.filter(n=>n.salesExecutiveId===e)}getReportDataForExecutive(e){const n=this.salesExecutivesSubject.value.find(u=>u.id===e),r=this.getSalesRecordsForExecutive(e),c=this.getIncentivesForExecutive(e),a=r.filter(u=>"completed"===u.status).reduce((u,m)=>u+m.amount,0),h=c.filter(u=>"pending"!==u.status).reduce((u,m)=>u+m.amount,0),p=[];for(let u=5;u>=0;u--){const m=new Date;m.setMonth(m.getMonth()-u);const I=m.toISOString().substring(0,7),Q=r.filter(x=>x.date.toISOString().substring(0,7)===I&&"completed"===x.status).reduce((x,k)=>x+k.amount,0),q=c.filter(x=>x.earnedDate.toISOString().substring(0,7)===I&&"pending"!==x.status).reduce((x,k)=>x+k.amount,0);p.push({month:I,sales:Q,incentives:q})}return{salesExecutiveId:e,salesExecutiveName:n?.name||"Unknown",totalSales:a,totalIncentives:h,period:"Last 6 months",breakdown:p}}getSalesExecutives(){return this.salesExecutivesSubject.value}getIncentiveRules(){return this.incentiveRulesSubject.value}addIncentiveRule(e){this.incentiveRulesSubject.next([...this.incentiveRulesSubject.value,e])}updateIncentiveRule(e,n){const c=this.incentiveRulesSubject.value.map(a=>a.id===e?{...a,...n}:a);this.incentiveRulesSubject.next(c)}deleteIncentiveRule(e){const r=this.incentiveRulesSubject.value.filter(c=>c.id!==e);this.incentiveRulesSubject.next(r)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var y=s(3540);function S(o,g){if(1&o&&(t.\u0275\u0275elementStart(0,"option",14),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=g.$implicit;t.\u0275\u0275property("value",e.id),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(e.name)}}function O(o,g){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",11)(2,"label",12),t.\u0275\u0275text(3,"View data for:"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"select",13),t.\u0275\u0275twoWayListener("ngModelChange",function(r){t.\u0275\u0275restoreView(e);const c=t.\u0275\u0275nextContext();return t.\u0275\u0275twoWayBindingSet(c.selectedSalesExecutiveId,r)||(c.selectedSalesExecutiveId=r),t.\u0275\u0275resetView(r)}),t.\u0275\u0275listener("change",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.onSalesExecutiveChange())}),t.\u0275\u0275elementStart(5,"option",14),t.\u0275\u0275text(6,"My Data"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(7,S,2,2,"option",15),t.\u0275\u0275elementEnd()()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(4),t.\u0275\u0275twoWayProperty("ngModel",e.selectedSalesExecutiveId),t.\u0275\u0275advance(),t.\u0275\u0275property("value",e.currentUser.id),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.salesExecutives)}}function P(o,g){if(1&o&&(t.\u0275\u0275elementStart(0,"span",16),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate2(" ",e.currentUser.name," (",e.currentUser.role,") ")}}function F(o,g){if(1&o&&(t.\u0275\u0275elementStart(0,"a",20),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=g.$implicit;t.\u0275\u0275property("routerLink","/"+e.route),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",e.displayName," ")}}function _(o,g){if(1&o&&(t.\u0275\u0275elementStart(0,"nav",17),t.\u0275\u0275template(1,F,2,2,"a",18),t.\u0275\u0275elementStart(2,"a",19),t.\u0275\u0275text(3,"Lazy Demo"),t.\u0275\u0275elementEnd()()),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275property("ngForOf",e.availableMfes)}}let $=(()=>{class o{constructor(e,n,r,c,a,h,p){this.auth2=e,this.auth=n,this.route=r,this.router=c,this.roleService=a,this.dummyDataService=h,this.mfeLoader=p,this.title="Incentive Management System",this.currentUser=null,this.availableMfes=[],this.salesExecutives=[],this.selectedSalesExecutiveId="",this.canViewOthers=!1,this.user=null,this.mfe1="pokemon",this.isAuthenticated=!1,this.userInfo=null,this.message="Processing authentication...",this.isProcessing=!0,this.mfeLoader.setConfigs(D.R)}ngOnInit(){var e=this;return(0,M.A)(function*(){e.roleService.currentUser$.subscribe(h=>{e.currentUser=h,h&&(e.selectedSalesExecutiveId=h.id,e.canViewOthers=e.roleService.canViewOthersData(),e.updateAvailableMfes(),e.loadSalesExecutives(),e.preloadMfes())});let n=null,r=null,c=null;const a=yield(0,d.firstValueFrom)(e.route.queryParams);if(console.log("Hey Jude"," param =",a," code = ",a.code),a&&Object.keys(a).length>0)n=a.code??null,r=a.state??null,c=a.error??null;else{const h=new URLSearchParams(window.location.search);n=h.get("code"),r=h.get("state"),c=h.get("error")}if(c)return e.message=`Authentication failed: ${c}`,e.isProcessing=!1,void setTimeout(()=>e.router.navigate(["/"]),3e3);if(n&&r)try{(yield e.auth.handleCallback(n,r))?(e.message="Authentication successful! Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),1500)):(e.message="Authentication failed. Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3))}catch{e.message="Authentication failed (exception). Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3)}else e.message="Invalid callback parameters. Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3)})()}updateAvailableMfes(){this.availableMfes=this.currentUser?this.mfeLoader.getConfigsForRole(this.currentUser.role):[]}loadSalesExecutives(){this.canViewOthers&&(this.salesExecutives=this.dummyDataService.getSalesExecutives())}preloadMfes(){var e=this;return(0,M.A)(function*(){if(e.currentUser)try{yield e.mfeLoader.preloadPriorityMfes(e.currentUser.role),console.log("[AppComponent] Priority MFEs preloaded")}catch(n){console.error("[AppComponent] Error preloading MFEs:",n)}})()}onSalesExecutiveChange(){console.log(`[AppComponent] Selected sales executive: ${this.selectedSalesExecutiveId}`),sessionStorage.setItem("selected_sales_executive_id",this.selectedSalesExecutiveId),window.dispatchEvent(new CustomEvent("salesExecutiveChanged",{detail:{salesExecutiveId:this.selectedSalesExecutiveId}}))}login(){this.auth.login()}logout(){this.auth.logout(),this.roleService.setCurrentUser(null)}fetchUser(){}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(T),t.\u0275\u0275directiveInject(l.AuthService),t.\u0275\u0275directiveInject(E.ActivatedRoute),t.\u0275\u0275directiveInject(E.Router),t.\u0275\u0275directiveInject(f),t.\u0275\u0275directiveInject(j),t.\u0275\u0275directiveInject(y.MfeLoaderService))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-root"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:13,vars:3,consts:[[1,"app-container"],[1,"app-header"],[1,"header-left"],[1,"app-title"],["class","header-center",4,"ngIf"],[1,"header-right"],["class","user-info",4,"ngIf"],[1,"btn-logout",3,"click"],["class","app-nav",4,"ngIf"],[1,"app-content"],[1,"header-center"],[1,"user-selector"],["for","salesExecSelect"],["id","salesExecSelect",3,"ngModelChange","change","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"user-info"],[1,"app-nav"],["routerLinkActive","active","class","nav-link",3,"routerLink",4,"ngFor","ngForOf"],["routerLink","/lazy","routerLinkActive","active",1,"nav-link"],["routerLinkActive","active",1,"nav-link",3,"routerLink"]],template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),t.\u0275\u0275text(4,"Incentive Management System"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(5,O,8,3,"div",4),t.\u0275\u0275elementStart(6,"div",5),t.\u0275\u0275template(7,P,2,2,"span",6),t.\u0275\u0275elementStart(8,"button",7),t.\u0275\u0275listener("click",function(){return r.logout()}),t.\u0275\u0275text(9,"Logout"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275template(10,_,4,1,"nav",8),t.\u0275\u0275elementStart(11,"main",9),t.\u0275\u0275element(12,"router-outlet"),t.\u0275\u0275elementEnd()()),2&n&&(t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",r.currentUser&&r.canViewOthers),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",r.currentUser),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",r.currentUser))},dependencies:[E.RouterOutlet,b.CommonModule,b.NgForOf,b.NgIf,E.RouterLink,E.RouterLinkActive,C.FormsModule,C.NgSelectOption,C.\u0275NgSelectMultipleOption,C.SelectControlValueAccessor,C.NgControlStatus,C.NgModel],styles:['[_nghost-%COMP%]{--bright-blue: oklch(51.01% .274 263.83);--electric-violet: oklch(53.18% .28 296.97);--french-violet: oklch(47.66% .246 305.88);--vivid-pink: oklch(69.02% .277 332.77);--hot-red: oklch(61.42% .238 15.34);--orange-red: oklch(63.32% .24 31.68);--gray-900: oklch(19.37% .006 300.98);--gray-700: oklch(36.98% .014 302.71);--gray-400: oklch(70.9% .015 304.04);--red-to-pink-to-purple-vertical-gradient: linear-gradient( 180deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--red-to-pink-to-purple-horizontal-gradient: linear-gradient( 90deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--pill-accent: var(--bright-blue);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.app-header[_ngcontent-%COMP%]{background:#fff;padding:1rem 2rem;border-bottom:2px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px #0000001a}.header-left[_ngcontent-%COMP%]{flex:1}.app-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:var(--gray-900);font-weight:600}.header-center[_ngcontent-%COMP%]{flex:2;display:flex;justify-content:center}.user-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.user-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--gray-700);font-weight:500}.user-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid var(--gray-400);border-radius:.375rem;font-size:.875rem;background:#fff;cursor:pointer;min-width:200px}.header-right[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:flex-end;align-items:center;gap:1rem}.user-info[_ngcontent-%COMP%]{color:var(--gray-700);font-size:.875rem;font-weight:500}.btn-logout[_ngcontent-%COMP%]{background:var(--hot-red);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.375rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-logout[_ngcontent-%COMP%]:hover{background:var(--orange-red)}.app-nav[_ngcontent-%COMP%]{background:var(--gray-900);padding:0;display:flex;gap:0}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:1rem 1.5rem;font-size:.875rem;font-weight:500;transition:background .2s ease;border-bottom:3px solid transparent}.nav-link[_ngcontent-%COMP%]:hover{background:var(--gray-700)}.nav-link.active[_ngcontent-%COMP%]{background:var(--bright-blue);border-bottom-color:var(--electric-violet)}.app-content[_ngcontent-%COMP%]{flex:1;padding:2rem;background:#f5f5f5}.auth-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:#fff;padding:1rem 2rem;border-bottom:1px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 2px 4px #0000001a}.auth-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-name[_ngcontent-%COMP%]{color:var(--gray-900);font-weight:500}.auth-button[_ngcontent-%COMP%]{background:var(--bright-blue);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .3s ease}.auth-button[_ngcontent-%COMP%]:hover{background:var(--electric-violet)}.logout-button[_ngcontent-%COMP%]{background:var(--hot-red)}.logout-button[_ngcontent-%COMP%]:hover{background:var(--orange-red)}']})}}return o})();var U=s(8049);let B=(()=>{class o{constructor(e){this.$http=e,this.$masterSet=new d.BehaviorSubject([]),this.$loadMoreEvent=new d.BehaviorSubject(""),this.url="https://pokeapi.co/api/v2/pokemon/?offset=0&limit=20",this.$http.get(this.url).pipe((0,d.tap)(({next:n})=>{this.next=n}),(0,d.map)(({results:n})=>n)).subscribe(n=>this.$masterSet.next(n)),this.$loadMoreEvent.pipe((0,d.debounceTime)(500)).subscribe(n=>{"loadMore"===n&&this.loadMore()})}loadMore(){this.next&&this.$http.get(this.next).pipe((0,d.tap)(({next:e})=>{this.next=e}),(0,d.map)(({results:e})=>e)).subscribe(e=>{this.$masterSet.next([...this.$masterSet.value,...e])})}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(v.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),N=(()=>{class o{constructor(e){this.zone=e}start(e){this.eventSource=new EventSource(e);const n=this.eventSource;return new d.Observable(r=>{const c=(0,d.fromEvent)(n,"message").subscribe(a=>{this.zone.run(()=>r.next(a.data))});return n.onerror=a=>{this.zone.run(()=>r.error(a))},()=>{c.unsubscribe(),n.close()}})}stop(){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0)}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(t.NgZone))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function z(o,g){if(1&o&&(t.\u0275\u0275elementStart(0,"li"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=g.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(e.name)}}let V=(()=>{class o{constructor(e,n,r){this.pokemonService=e,this.destroyRef=n,this.sseService=r,this.messages=[],(0,d.fromEvent)(window,"scroll").pipe((0,U.takeUntilDestroyed)(this.destroyRef),(0,d.map)(()=>window.scrollY+window.innerHeight>=document.body.scrollHeight),(0,d.distinctUntilChanged)(),(0,d.filter)(c=>!0===c)).subscribe(()=>{this.pokemonService.$loadMoreEvent.next("loadMore")}),console.log("LazyloadComponent constructed")}referId(e,n){return n.name}ngOnInit(){}start(){this.sseService.start("https://stream.wikimedia.org/v2/stream/recentchange").pipe((0,U.takeUntilDestroyed)(this.destroyRef)).subscribe({next:e=>{console.log("SSE:",e),this.messages.push(e)},error:e=>console.error("SSE error",e)})}stop(){console.log("SSE stopped"),this.sseService.stop()}ngOnDestroy(){console.log("LazyloadComponent destroyed")}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(B),t.\u0275\u0275directiveInject(t.DestroyRef),t.\u0275\u0275directiveInject(N))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-lazyload"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:9,vars:4,consts:[[1,"px-4","py-2","bg-green-500","text-white","rounded","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"lazyload works!"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(2,"button",0),t.\u0275\u0275listener("click",function(){return r.start()}),t.\u0275\u0275text(3,"Start"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"button",1),t.\u0275\u0275listener("click",function(){return r.stop()}),t.\u0275\u0275text(5,"Stop"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"ul"),t.\u0275\u0275template(7,z,2,1,"li",2),t.\u0275\u0275pipe(8,"async"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(7),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(8,2,r.pokemonService.$masterSet))("ngForTrackBy",r.referId))},dependencies:[b.CommonModule,b.NgForOf,b.AsyncPipe]})}}return o})();var W=s(762),G=s.n(W);let J=(()=>{class o{constructor(){this.emitter=G()();const e=new Event("EventBusServiceCreated");this.onePlusNEvents=new d.ReplaySubject(100),this.onePlusNEvents.next(e.type),this.emitter.on("*",n=>this.onePlusNEvents.next(n))}sendEvent(e){this.emitter.emit(e)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),H=(()=>{class o{constructor(e,n){this.eventBus=e,this.destroyRef=n,this.eventBus.onePlusNEvents.pipe((0,U.takeUntilDestroyed)(this.destroyRef),(0,d.filter)(r=>"JOJO"===r)).subscribe(this.catchJojo)}catchJojo(e){console.log("PUTIN!!")}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(J),t.\u0275\u0275directiveInject(t.DestroyRef))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-funny"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"funny works!"),t.\u0275\u0275elementEnd())}})}}return o})();function w(o){return()=>{const g=(0,t.inject)(f),e=(0,t.inject)(E.Router),n=g.getCurrentUser();return n?!!o.includes(n.role)||(console.warn(`[RoleGuard] User role ${n.role} not allowed, redirecting to home`),e.navigate(["/"]),!1):(console.warn("[RoleGuard] No user found, redirecting to home"),e.navigate(["/"]),!1)}}const K=w([i.g.SUPER_ADMIN,i.g.ORG_ADMIN,i.g.TEAM_LEAD]),X=(w([i.g.SUPER_ADMIN,i.g.ORG_ADMIN]),[{path:"lazy",component:V},{path:"funny",component:H},{path:"auth-callback",loadComponent:()=>s.e(472).then(s.bind(s,4472)).then(o=>o.AuthCallbackComponent)},{path:"rules",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(o=>o.CRUD_RULES_ROUTES),canActivate:[K]},{path:"sales",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(o=>o.MY_SALES_ROUTES),canActivate:[w([i.g.SUPER_ADMIN,i.g.ORG_ADMIN,i.g.TEAM_LEAD,i.g.SALES_EXECUTIVE])]},{path:"reports",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(o=>o.MY_REPORT_ROUTES),canActivate:[w([i.g.SUPER_ADMIN,i.g.ORG_ADMIN,i.g.TEAM_LEAD,i.g.SALES_EXECUTIVE])]},{path:"**",redirectTo:"",pathMatch:"full"}]),Y=(o,g)=>new d.Observable(e=>{let n;return(0,M.A)(function*(){const{urlWithParams:c}=o,h=yield caches.open("http"),p=yield h.match(c);if(p){let u;console.log("Serve from Cache for",c);try{u=yield p.clone().json()}catch{u=yield p.clone().text()}return e.next(new v.HttpResponse({body:u,status:p.status||200,url:o.urlWithParams})),void e.complete()}var u;n=g(o).subscribe({next:(u=(0,M.A)(function*(m){if(console.log("Cache miss for ",c),e.next(m),m instanceof v.HttpResponse&&m.ok){const I=new Response(JSON.stringify(m.body),{headers:{"Content-Type":"application/json"},status:m.status,statusText:m.statusText});yield h.put(o.urlWithParams,I)}}),function(I){return u.apply(this,arguments)}),error:u=>e.error(u),complete:()=>e.complete()})})(),()=>n?.unsubscribe()});function Z(){return(0,A.bootstrapApplication)($,{providers:[(0,E.provideRouter)(X),(0,v.provideHttpClient)((0,v.withFetch)(),(0,v.withInterceptors)([Y]))]})}}}]);