(self.webpackChunkshell=self.webpackChunkshell||[]).push([[681],{1633:(G,T,a)=>{a.d(T,{n:()=>V});var A=a(467),r=a(5565),x=a(7412),O=a(1913),D=a(5315),C=a(3319),m=a(3540);const d=["container"],P=["mfeContainer"],U=["mfeWrapper"];function R(g,w){1&g&&r.\u0275\u0275elementContainer(0,null,0)}function b(g,w){1&g&&(r.\u0275\u0275elementStart(0,"span",13),r.\u0275\u0275text(1,"Loading..."),r.\u0275\u0275elementEnd())}function F(g,w){if(1&g&&(r.\u0275\u0275elementStart(0,"span",14),r.\u0275\u0275text(1),r.\u0275\u0275elementEnd()),2&g){const s=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(),r.\u0275\u0275textInterpolate1("Error: ",s.error,"")}}function k(g,w){if(1&g&&(r.\u0275\u0275elementStart(0,"div",15)(1,"p"),r.\u0275\u0275text(2),r.\u0275\u0275elementEnd()()),2&g){const s=r.\u0275\u0275nextContext().$implicit;r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate1("Scroll to load ",s.name,"")}}function z(g,w){if(1&g&&(r.\u0275\u0275elementStart(0,"div",7,1)(2,"div",8)(3,"h3"),r.\u0275\u0275text(4),r.\u0275\u0275elementEnd(),r.\u0275\u0275template(5,b,2,0,"span",9)(6,F,2,1,"span",10),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"div",11),r.\u0275\u0275elementContainer(8,null,2),r.\u0275\u0275template(10,k,3,1,"div",12),r.\u0275\u0275elementEnd()()),2&g){const s=w.$implicit,l=w.index,c=r.\u0275\u0275nextContext(2);r.\u0275\u0275attribute("data-mfe-index",l),r.\u0275\u0275advance(4),r.\u0275\u0275textInterpolate(s.name),r.\u0275\u0275advance(),r.\u0275\u0275property("ngIf",s.loading),r.\u0275\u0275advance(),r.\u0275\u0275property("ngIf",s.error),r.\u0275\u0275advance(4),r.\u0275\u0275property("ngIf",!s.loaded&&!s.loading&&c.lazyLoad)}}function N(g,w){if(1&g&&(r.\u0275\u0275elementStart(0,"div",5),r.\u0275\u0275template(1,z,11,5,"div",6),r.\u0275\u0275elementEnd()),2&g){const s=r.\u0275\u0275nextContext();r.\u0275\u0275advance(),r.\u0275\u0275property("ngForOf",s.mfeStates)}}let V=(()=>{class g{constructor(s,l,c){this.route=s,this.mfeLoader=l,this.cdr=c,this.name="",this.names=[],this.lazyLoad=!0,this.mfeStates=[],this.mfeLoader.setConfigs(x.R)}ngAfterViewInit(){var s=this;return(0,A.A)(function*(){let l=[];if(s.names&&s.names.length>0)l=s.names;else{const c=s.route.snapshot.data.mfeName||s.name;c&&(l=[c])}0!==l.length?(s.mfeStates=l.map(c=>({name:c,loaded:!1,loading:!1})),s.cdr.detectChanges(),1===l.length&&s.remoteContainer?yield s.loadSingleMfe(l[0],s.remoteContainer):s.lazyLoad?s.setupLazyLoading():yield s.loadAllMfes()):console.error("[MfeWrapperComponent] No MFE name(s) provided")})()}loadSingleMfe(s,l){var c=this;return(0,A.A)(function*(){const v=c.mfeLoader.getConfigByName(s);if(v){try{const S=yield c.mfeLoader.loadMfe(v);S&&S.AppComponent&&l.createComponent(S.AppComponent)}catch(S){console.error(`[MfeWrapperComponent] Error loading MFE ${s}:`,S)}return}const _=x.A.find(({remoteName:S})=>S===s),B=_?{remoteName:_.remoteName,exposedModule:_.exposedModule}:void 0;if(!B)return void console.error(`[MfeWrapperComponent] MFE ${s} not found in configurations`);const $=yield(0,O.loadRemoteModule)(B);l.createComponent($.AppComponent)})()}setupLazyLoading(){if(!("IntersectionObserver"in window))return console.warn("[MfeWrapperComponent] IntersectionObserver not supported, loading all MFEs"),void this.loadAllMfes();this.intersectionObserver=new IntersectionObserver(s=>{s.forEach(l=>{if(l.isIntersecting){const c=parseInt(l.target.getAttribute("data-mfe-index")||"0",10);if(c>=0&&c<this.mfeStates.length){const v=this.mfeStates[c];!v.loaded&&!v.loading&&this.loadMfeAtIndex(c)}}})},{root:null,rootMargin:"50px",threshold:.01}),setTimeout(()=>{this.mfeWrappers.forEach(s=>{this.intersectionObserver&&this.intersectionObserver.observe(s.nativeElement)})},0)}loadMfeAtIndex(s){var l=this;return(0,A.A)(function*(){const c=l.mfeStates[s];if(!c.loaded&&!c.loading){c.loading=!0,l.cdr.detectChanges();try{const _=l.mfeContainers.toArray()[s];if(!_)return void console.error(`[MfeWrapperComponent] Container not found for index ${s}`);yield l.loadMfeIntoContainer(c.name,_),c.loaded=!0,c.loading=!1}catch(v){console.error(`[MfeWrapperComponent] Error loading MFE ${c.name}:`,v),c.error=v instanceof Error?v.message:"Unknown error",c.loading=!1}l.cdr.detectChanges()}})()}loadAllMfes(){var s=this;return(0,A.A)(function*(){for(let l=0;l<s.mfeStates.length;l++)yield s.loadMfeAtIndex(l)})()}loadMfeIntoContainer(s,l){var c=this;return(0,A.A)(function*(){const v=c.mfeLoader.getConfigByName(s);if(v){const S=yield c.mfeLoader.loadMfe(v);if(S&&S.AppComponent)return void l.createComponent(S.AppComponent)}const _=x.A.find(({remoteName:S})=>S===s);if(!_)throw new Error(`MFE ${s} not found in configurations`);const B={remoteName:_.remoteName,exposedModule:_.exposedModule},$=yield(0,O.loadRemoteModule)(B);l.createComponent($.AppComponent)})()}ngOnDestroy(){this.intersectionObserver&&this.intersectionObserver.disconnect()}static{this.\u0275fac=function(l){return new(l||g)(r.\u0275\u0275directiveInject(C.ActivatedRoute),r.\u0275\u0275directiveInject(m.MfeLoaderService),r.\u0275\u0275directiveInject(r.ChangeDetectorRef))}}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:g,selectors:[["app-mfe-wrapper"]],viewQuery:function(l,c){if(1&l&&(r.\u0275\u0275viewQuery(d,5,r.ViewContainerRef),r.\u0275\u0275viewQuery(P,5,r.ViewContainerRef),r.\u0275\u0275viewQuery(U,5,r.ElementRef)),2&l){let v;r.\u0275\u0275queryRefresh(v=r.\u0275\u0275loadQuery())&&(c.remoteContainer=v.first),r.\u0275\u0275queryRefresh(v=r.\u0275\u0275loadQuery())&&(c.mfeContainers=v),r.\u0275\u0275queryRefresh(v=r.\u0275\u0275loadQuery())&&(c.mfeWrappers=v)}},inputs:{name:"name",names:"names",lazyLoad:"lazyLoad"},standalone:!0,features:[r.\u0275\u0275StandaloneFeature],decls:2,vars:2,consts:[["container",""],["mfeWrapper",""],["mfeContainer",""],[4,"ngIf"],["class","mfe-grid",4,"ngIf"],[1,"mfe-grid"],["class","mfe-wrapper",4,"ngFor","ngForOf"],[1,"mfe-wrapper"],[1,"mfe-header"],["class","mfe-loading",4,"ngIf"],["class","mfe-error",4,"ngIf"],[1,"mfe-content"],["class","mfe-placeholder",4,"ngIf"],[1,"mfe-loading"],[1,"mfe-error"],[1,"mfe-placeholder"]],template:function(l,c){1&l&&r.\u0275\u0275template(0,R,2,0,"ng-container",3)(1,N,2,1,"div",4),2&l&&(r.\u0275\u0275property("ngIf",1===c.mfeStates.length),r.\u0275\u0275advance(),r.\u0275\u0275property("ngIf",c.mfeStates.length>1))},dependencies:[D.CommonModule,D.NgForOf,D.NgIf],styles:[".mfe-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem;padding:1rem}.mfe-wrapper[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;overflow:hidden;background:#fff;box-shadow:0 2px 4px #0000001a;min-height:200px}.mfe-header[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center}.mfe-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600;text-transform:capitalize}.mfe-loading[_ngcontent-%COMP%]{color:#1976d2;font-size:.9rem;font-style:italic}.mfe-error[_ngcontent-%COMP%]{color:#d32f2f;font-size:.9rem}.mfe-content[_ngcontent-%COMP%]{padding:1rem;min-height:150px}.mfe-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:150px;color:#757575;font-style:italic}.mfe-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}"],changeDetection:0})}}return g})()},3540:(G,T,a)=>{a.d(T,{MfeLoaderService:()=>e});var A=a(467),r=a(2485),x=a(1913),h=a(5565);let e=(()=>{class C{constructor(){this.mfeConfigs=[],this.loadedMfesSubject=new r.BehaviorSubject(new Set),this.loadedMfes$=this.loadedMfesSubject.asObservable(),this.loadingMfesSubject=new r.BehaviorSubject(new Set),this.loadingMfes$=this.loadingMfesSubject.asObservable()}setConfigs(m){this.mfeConfigs=m.sort((d,P)=>P.priority-d.priority)}getConfigs(){return this.mfeConfigs}getConfigsForRole(m){return this.mfeConfigs.filter(d=>d.allowedRoles.includes(m))}getConfigByName(m){return this.mfeConfigs.find(d=>d.name===m)}preloadPriorityMfes(m){var d=this;return(0,A.A)(function*(){const R=d.getConfigsForRole(m).filter(b=>b.priority>=5).map(b=>d.loadMfe(b));yield Promise.all(R)})()}loadMfe(m){var d=this;return(0,A.A)(function*(){const P=d.loadingMfesSubject.value,U=d.loadedMfesSubject.value;if(U.has(m.name))console.log(`[MfeLoaderService] MFE ${m.name} already loaded`);else if(P.has(m.name))console.log(`[MfeLoaderService] MFE ${m.name} is already loading`);else try{const R=new Set(P);R.add(m.name),d.loadingMfesSubject.next(R),console.log(`[MfeLoaderService] Loading MFE ${m.name} (priority: ${m.priority})`);const b=yield(0,x.loadRemoteModule)({type:"module",remoteEntry:m.url,exposedModule:m.exposedModule}),F=new Set(U);F.add(m.name),d.loadedMfesSubject.next(F);const k=new Set(d.loadingMfesSubject.value);return k.delete(m.name),d.loadingMfesSubject.next(k),console.log(`[MfeLoaderService] Successfully loaded MFE ${m.name}`),b}catch(R){console.error(`[MfeLoaderService] Error loading MFE ${m.name}:`,R);const b=new Set(d.loadingMfesSubject.value);throw b.delete(m.name),d.loadingMfesSubject.next(b),R}})()}isMfeLoaded(m){return this.loadedMfesSubject.value.has(m)}isMfeLoading(m){return this.loadingMfesSubject.value.has(m)}static{this.\u0275fac=function(d){return new(d||C)}}static{this.\u0275prov=h.\u0275\u0275defineInjectable({token:C,factory:C.\u0275fac,providedIn:"root"})}}return C})()},681:(G,T,a)=>{a.r(T),a.d(T,{bootstrap:()=>q});var A=a(1194),r=a(467),j=a(3319),x=a(5315),O=a(3793),h=a(2485),D=a(7412),e=a(5565),C=a(1663);let J=(()=>{class o{constructor(t){this.http=t}login(){window.location.href="http://localhost:4000/auth/login"}logout(){window.location.href="http://localhost:4000/auth/logout"}getUserProfile(){return this.http.get("http://localhost:4000/auth/me",{withCredentials:!0})}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275inject(C.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var m=a(8662),d=a(9903);let P=(()=>{class o{constructor(){this.currentUserSubject=new h.BehaviorSubject(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadDummyUser()}loadDummyUser(){const t=sessionStorage.getItem("current_user");t?this.currentUserSubject.next(JSON.parse(t)):this.setCurrentUser({id:"1",name:"John Doe",email:"john.doe@example.com",role:d.g.SALES_EXECUTIVE})}setCurrentUser(t){this.currentUserSubject.next(t),t?sessionStorage.setItem("current_user",JSON.stringify(t)):sessionStorage.removeItem("current_user")}getCurrentUser(){return this.currentUserSubject.value}getCurrentUserRole(){return this.currentUserSubject.value?.role||null}hasRole(t){const n=this.getCurrentUserRole();return!!n&&(0,d.W)(n,t)}canViewOthersData(){const t=this.getCurrentUserRole();return t===d.g.SUPER_ADMIN||t===d.g.ORG_ADMIN||t===d.g.TEAM_LEAD}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),U=(()=>{class o{constructor(){this.salesExecutivesSubject=new h.BehaviorSubject(this.generateSalesExecutives()),this.salesExecutives$=this.salesExecutivesSubject.asObservable(),this.salesRecordsSubject=new h.BehaviorSubject(this.generateSalesRecords()),this.salesRecords$=this.salesRecordsSubject.asObservable(),this.incentiveRulesSubject=new h.BehaviorSubject(this.generateIncentiveRules()),this.incentiveRules$=this.incentiveRulesSubject.asObservable(),this.incentivesEarnedSubject=new h.BehaviorSubject(this.generateIncentivesEarned()),this.incentivesEarned$=this.incentivesEarnedSubject.asObservable()}generateSalesExecutives(){return[{id:"1",name:"John Doe",email:"john.doe@example.com",teamId:"team1"},{id:"2",name:"Jane Smith",email:"jane.smith@example.com",teamId:"team1"},{id:"3",name:"Bob Johnson",email:"bob.johnson@example.com",teamId:"team2"},{id:"4",name:"Alice Williams",email:"alice.williams@example.com",teamId:"team2"},{id:"5",name:"Charlie Brown",email:"charlie.brown@example.com",teamId:"team1"}]}generateSalesRecords(){const t=[],n=this.generateSalesExecutives(),i=["Product A","Product B","Product C","Product D"],f=["completed","pending","cancelled"];for(let u=0;u<50;u++){const M=n[u%n.length],E=Math.floor(u/10),p=new Date;p.setMonth(p.getMonth()-E),t.push({id:`sale-${u+1}`,salesExecutiveId:M.id,salesExecutiveName:M.name,date:p,productName:i[u%i.length],amount:Math.floor(5e4*Math.random())+1e4,quantity:Math.floor(10*Math.random())+1,status:f[u%3]})}return t}generateIncentiveRules(){return[{id:"rule-1",name:"Basic Sales Incentive",description:"5% incentive on all sales",type:"percentage",value:5,isActive:!0,createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"rule-2",name:"High Value Sales Bonus",description:"10% incentive on sales above $50,000",type:"percentage",value:10,minSalesAmount:5e4,isActive:!0,createdBy:"admin",createdAt:new Date("2024-02-01")},{id:"rule-3",name:"Product A Special",description:"Fixed $500 bonus for Product A sales",type:"fixed",value:500,productCategory:"Product A",isActive:!0,createdBy:"team-lead-1",createdAt:new Date("2024-03-01")},{id:"rule-4",name:"Tiered Volume Incentive",description:"15% incentive on sales above $100,000",type:"tiered",value:15,minSalesAmount:1e5,isActive:!1,createdBy:"admin",createdAt:new Date("2024-04-01")}]}generateIncentivesEarned(){const t=[],n=this.generateSalesExecutives(),i=this.generateIncentiveRules(),f=["pending","approved","paid"];for(let u=0;u<30;u++){const M=n[u%n.length],E=i[u%i.length],p=Math.floor(u/10),y=new Date;y.setMonth(y.getMonth()-p),t.push({id:`incentive-${u+1}`,salesExecutiveId:M.id,salesExecutiveName:M.name,ruleId:E.id,ruleName:E.name,salesRecordId:`sale-${u+1}`,amount:Math.floor(5e3*Math.random())+500,earnedDate:y,status:f[u%3]})}return t}getSalesRecordsForExecutive(t){return this.salesRecordsSubject.value.filter(n=>n.salesExecutiveId===t)}getIncentivesForExecutive(t){return this.incentivesEarnedSubject.value.filter(n=>n.salesExecutiveId===t)}getReportDataForExecutive(t){const n=this.salesExecutivesSubject.value.find(p=>p.id===t),i=this.getSalesRecordsForExecutive(t),f=this.getIncentivesForExecutive(t),u=i.filter(p=>"completed"===p.status).reduce((p,y)=>p+y.amount,0),M=f.filter(p=>"pending"!==p.status).reduce((p,y)=>p+y.amount,0),E=[];for(let p=5;p>=0;p--){const y=new Date;y.setMonth(y.getMonth()-p);const W=y.toISOString().substring(0,7),ee=i.filter(L=>L.date.toISOString().substring(0,7)===W&&"completed"===L.status).reduce((L,K)=>L+K.amount,0),te=f.filter(L=>L.earnedDate.toISOString().substring(0,7)===W&&"pending"!==L.status).reduce((L,K)=>L+K.amount,0);E.push({month:W,sales:ee,incentives:te})}return{salesExecutiveId:t,salesExecutiveName:n?.name||"Unknown",totalSales:u,totalIncentives:M,period:"Last 6 months",breakdown:E}}getSalesExecutives(){return this.salesExecutivesSubject.value}getIncentiveRules(){return this.incentiveRulesSubject.value}addIncentiveRule(t){this.incentiveRulesSubject.next([...this.incentiveRulesSubject.value,t])}updateIncentiveRule(t,n){const f=this.incentiveRulesSubject.value.map(u=>u.id===t?{...u,...n}:u);this.incentiveRulesSubject.next(f)}deleteIncentiveRule(t){const i=this.incentiveRulesSubject.value.filter(f=>f.id!==t);this.incentiveRulesSubject.next(i)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var R=a(3540);function b(o,I){if(1&o&&(e.\u0275\u0275elementStart(0,"option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=I.$implicit;e.\u0275\u0275property("value",t.id),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(t.name)}}function F(o,I){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",10)(1,"div",11)(2,"label",12),e.\u0275\u0275text(3,"View data for:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",13),e.\u0275\u0275text(5," Selecting a user will display their incentive data. "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"select",14),e.\u0275\u0275twoWayListener("ngModelChange",function(i){e.\u0275\u0275restoreView(t);const f=e.\u0275\u0275nextContext();return e.\u0275\u0275twoWayBindingSet(f.selectedSalesExecutiveId,i)||(f.selectedSalesExecutiveId=i),e.\u0275\u0275resetView(i)}),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.onSalesExecutiveChange())}),e.\u0275\u0275elementStart(7,"option",15),e.\u0275\u0275text(8,"My Data"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,b,2,2,"option",16),e.\u0275\u0275elementEnd()()()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275twoWayProperty("ngModel",t.selectedSalesExecutiveId),e.\u0275\u0275advance(),e.\u0275\u0275property("value",t.currentUser.id),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.salesExecutives)}}function k(o,I){if(1&o&&(e.\u0275\u0275elementStart(0,"span",17),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate2(" ",t.currentUser.name," (",t.currentUser.role,") ")}}function z(o,I){if(1&o&&(e.\u0275\u0275elementStart(0,"a",22),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=I.$implicit;e.\u0275\u0275property("routerLink","/"+t.route),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function N(o,I){if(1&o&&(e.\u0275\u0275elementStart(0,"nav",18),e.\u0275\u0275template(1,z,2,2,"a",19),e.\u0275\u0275elementStart(2,"a",20),e.\u0275\u0275text(3,"Lazy Demo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"a",21),e.\u0275\u0275text(5,"Multi-MFE Demo"),e.\u0275\u0275elementEnd()()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",t.availableMfes)}}let V=(()=>{class o{constructor(t,n,i,f,u,M,E){this.auth2=t,this.auth=n,this.route=i,this.router=f,this.roleService=u,this.dummyDataService=M,this.mfeLoader=E,this.title="Incentive Management System",this.currentUser=null,this.availableMfes=[],this.salesExecutives=[],this.selectedSalesExecutiveId="",this.canViewOthers=!1,this.user=null,this.mfe1="pokemon",this.isAuthenticated=!1,this.userInfo=null,this.message="Processing authentication...",this.isProcessing=!0,this.mfeLoader.setConfigs(D.R)}ngOnInit(){var t=this;return(0,r.A)(function*(){t.roleService.currentUser$.subscribe(M=>{t.currentUser=M,M&&(t.selectedSalesExecutiveId=M.id,t.canViewOthers=t.roleService.canViewOthersData(),t.updateAvailableMfes(),t.loadSalesExecutives(),t.preloadMfes())});let n=null,i=null,f=null;const u=yield(0,h.firstValueFrom)(t.route.queryParams);if(u&&Object.keys(u).length>0)n=u.code??null,i=u.state??null,f=u.error??null;else{const M=new URLSearchParams(window.location.search);n=M.get("code"),i=M.get("state"),f=M.get("error")}if(f)return t.message=`Authentication failed: ${f}`,t.isProcessing=!1,void setTimeout(()=>t.router.navigate(["/"]),3e3);if(n&&i)try{(yield t.auth.handleCallback(n,i))?(t.message="Authentication successful! Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),1500)):(t.message="Authentication failed. Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3))}catch{t.message="Authentication failed (exception). Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3)}else t.message="Invalid callback parameters. Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3)})()}updateAvailableMfes(){this.availableMfes=this.currentUser?this.mfeLoader.getConfigsForRole(this.currentUser.role):[]}loadSalesExecutives(){this.canViewOthers&&(this.salesExecutives=this.dummyDataService.getSalesExecutives())}preloadMfes(){var t=this;return(0,r.A)(function*(){if(t.currentUser)try{yield t.mfeLoader.preloadPriorityMfes(t.currentUser.role)}catch(n){console.error("[AppComponent] Error preloading MFEs:",n)}})()}onSalesExecutiveChange(){sessionStorage.setItem("selected_sales_executive_id",this.selectedSalesExecutiveId),window.dispatchEvent(new CustomEvent("salesExecutiveChanged",{detail:{salesExecutiveId:this.selectedSalesExecutiveId}}))}login(){this.auth.login()}logout(){this.auth.logout(),this.roleService.setCurrentUser(null)}fetchUser(){}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(J),e.\u0275\u0275directiveInject(m.AuthService),e.\u0275\u0275directiveInject(j.ActivatedRoute),e.\u0275\u0275directiveInject(j.Router),e.\u0275\u0275directiveInject(P),e.\u0275\u0275directiveInject(U),e.\u0275\u0275directiveInject(R.MfeLoaderService))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-root"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:13,vars:3,consts:[[1,"app-container"],[1,"app-header"],[1,"header-left"],[1,"app-title"],["class","header-center",4,"ngIf"],[1,"header-right"],["class","user-info",4,"ngIf"],[1,"btn-logout",3,"click"],["class","app-nav",4,"ngIf"],[1,"app-content"],[1,"header-center"],[1,"user-selector"],["for","salesExecSelect"],["id","salesExecSelectDesc",1,"visually-hidden"],["id","salesExecSelect","aria-describedby","salesExecSelectDesc",3,"ngModelChange","change","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"user-info"],[1,"app-nav"],["routerLinkActive","active","class","nav-link",3,"routerLink",4,"ngFor","ngForOf"],["routerLink","/lazy","routerLinkActive","active",1,"nav-link"],["routerLink","/multi-mfe-demo","routerLinkActive","active",1,"nav-link"],["routerLinkActive","active",1,"nav-link",3,"routerLink"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),e.\u0275\u0275text(4,"Incentive Management System"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(5,F,10,3,"div",4),e.\u0275\u0275elementStart(6,"div",5),e.\u0275\u0275template(7,k,2,2,"span",6),e.\u0275\u0275elementStart(8,"button",7),e.\u0275\u0275listener("click",function(){return i.logout()}),e.\u0275\u0275text(9,"Logout"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(10,N,6,1,"nav",8),e.\u0275\u0275elementStart(11,"main",9),e.\u0275\u0275element(12,"router-outlet"),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",i.currentUser&&i.canViewOthers),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.currentUser),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.currentUser))},dependencies:[j.RouterOutlet,x.CommonModule,x.NgForOf,x.NgIf,j.RouterLink,j.RouterLinkActive,O.FormsModule,O.NgSelectOption,O.\u0275NgSelectMultipleOption,O.SelectControlValueAccessor,O.NgControlStatus,O.NgModel],styles:['[_nghost-%COMP%]{--bright-blue: oklch(51.01% .274 263.83);--electric-violet: oklch(53.18% .28 296.97);--french-violet: oklch(47.66% .246 305.88);--vivid-pink: oklch(69.02% .277 332.77);--hot-red: oklch(61.42% .238 15.34);--orange-red: oklch(63.32% .24 31.68);--gray-900: oklch(19.37% .006 300.98);--gray-700: oklch(36.98% .014 302.71);--gray-400: oklch(70.9% .015 304.04);--red-to-pink-to-purple-vertical-gradient: linear-gradient( 180deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--red-to-pink-to-purple-horizontal-gradient: linear-gradient( 90deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--pill-accent: var(--bright-blue);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.app-header[_ngcontent-%COMP%]{background:#fff;padding:1rem 2rem;border-bottom:2px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px #0000001a}.header-left[_ngcontent-%COMP%]{flex:1}.app-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:var(--gray-900);font-weight:600}.header-center[_ngcontent-%COMP%]{flex:2;display:flex;justify-content:center}.user-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.user-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--gray-700);font-weight:500}.user-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid var(--gray-400);border-radius:.375rem;font-size:.875rem;background:#fff;cursor:pointer;min-width:200px}.header-right[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:flex-end;align-items:center;gap:1rem}.user-info[_ngcontent-%COMP%]{color:var(--gray-700);font-size:.875rem;font-weight:500}.btn-logout[_ngcontent-%COMP%]{background:var(--hot-red);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.375rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-logout[_ngcontent-%COMP%]:hover{background:var(--orange-red)}.app-nav[_ngcontent-%COMP%]{background:var(--gray-900);padding:0;display:flex;gap:0}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:1rem 1.5rem;font-size:.875rem;font-weight:500;transition:background .2s ease;border-bottom:3px solid transparent}.nav-link[_ngcontent-%COMP%]:hover{background:var(--gray-700)}.nav-link.active[_ngcontent-%COMP%]{background:var(--bright-blue);border-bottom-color:var(--electric-violet)}.app-content[_ngcontent-%COMP%]{flex:1;padding:2rem;background:#f5f5f5}.auth-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:#fff;padding:1rem 2rem;border-bottom:1px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 2px 4px #0000001a}.auth-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-name[_ngcontent-%COMP%]{color:var(--gray-900);font-weight:500}.auth-button[_ngcontent-%COMP%]{background:var(--bright-blue);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .3s ease}.auth-button[_ngcontent-%COMP%]:hover{background:var(--electric-violet)}.logout-button[_ngcontent-%COMP%]{background:var(--hot-red)}.logout-button[_ngcontent-%COMP%]:hover{background:var(--orange-red)}']})}}return o})();var g=a(8049);let w=(()=>{class o{constructor(t){this.$http=t,this.$masterSet=new h.BehaviorSubject([]),this.$loadMoreEvent=new h.BehaviorSubject(""),this.url="https://pokeapi.co/api/v2/pokemon/?offset=0&limit=20",this.$http.get(this.url).pipe((0,h.tap)(({next:n})=>{this.next=n}),(0,h.map)(({results:n})=>n)).subscribe(n=>this.$masterSet.next(n)),this.$loadMoreEvent.pipe((0,h.debounceTime)(500)).subscribe(n=>{"loadMore"===n&&this.loadMore()})}loadMore(){this.next&&this.$http.get(this.next).pipe((0,h.tap)(({next:t})=>{this.next=t}),(0,h.map)(({results:t})=>t)).subscribe(t=>{this.$masterSet.next([...this.$masterSet.value,...t])})}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275inject(C.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),s=(()=>{class o{constructor(t){this.zone=t}start(t){this.eventSource=new EventSource(t);const n=this.eventSource;return new h.Observable(i=>{const f=(0,h.fromEvent)(n,"message").subscribe(u=>{this.zone.run(()=>i.next(u.data))});return n.onerror=u=>{this.zone.run(()=>i.error(u))},()=>{f.unsubscribe(),n.close()}})}stop(){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0)}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275inject(e.NgZone))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function l(o,I){if(1&o&&(e.\u0275\u0275elementStart(0,"li"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=I.$implicit;e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(t.name)}}let c=(()=>{class o{constructor(t,n,i){this.pokemonService=t,this.destroyRef=n,this.sseService=i,this.messages=[],(0,h.fromEvent)(window,"scroll").pipe((0,g.takeUntilDestroyed)(this.destroyRef),(0,h.map)(()=>window.scrollY+window.innerHeight>=document.body.scrollHeight),(0,h.distinctUntilChanged)(),(0,h.filter)(f=>!0===f)).subscribe(()=>{this.pokemonService.$loadMoreEvent.next("loadMore")}),console.log("LazyloadComponent constructed")}referId(t,n){return n.name}ngOnInit(){}start(){this.sseService.start("https://stream.wikimedia.org/v2/stream/recentchange").pipe((0,g.takeUntilDestroyed)(this.destroyRef)).subscribe({next:t=>{console.log("SSE:",t),this.messages.push(t)},error:t=>console.error("SSE error",t)})}stop(){console.log("SSE stopped"),this.sseService.stop()}ngOnDestroy(){console.log("LazyloadComponent destroyed")}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(w),e.\u0275\u0275directiveInject(e.DestroyRef),e.\u0275\u0275directiveInject(s))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-lazyload"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:9,vars:4,consts:[[1,"px-4","py-2","bg-green-500","text-white","rounded","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1,"lazyload works!"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",0),e.\u0275\u0275listener("click",function(){return i.start()}),e.\u0275\u0275text(3,"Start"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",1),e.\u0275\u0275listener("click",function(){return i.stop()}),e.\u0275\u0275text(5,"Stop"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"ul"),e.\u0275\u0275template(7,l,2,1,"li",2),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(8,2,i.pokemonService.$masterSet))("ngForTrackBy",i.referId))},dependencies:[x.CommonModule,x.NgForOf,x.AsyncPipe]})}}return o})();var v=a(762),_=a.n(v);let B=(()=>{class o{constructor(){this.emitter=_()();const t=new Event("EventBusServiceCreated");this.onePlusNEvents=new h.ReplaySubject(100),this.onePlusNEvents.next(t.type),this.emitter.on("*",n=>this.onePlusNEvents.next(n))}sendEvent(t){this.emitter.emit(t)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),$=(()=>{class o{constructor(t,n){this.eventBus=t,this.destroyRef=n,this.eventBus.onePlusNEvents.pipe((0,g.takeUntilDestroyed)(this.destroyRef),(0,h.filter)(i=>"JOJO"===i)).subscribe(this.catchJojo)}catchJojo(t){console.log("PUTIN!!")}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(B),e.\u0275\u0275directiveInject(e.DestroyRef))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-funny"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1,"funny works!"),e.\u0275\u0275elementEnd())}})}}return o})();function S(o){return()=>{const I=(0,e.inject)(P),t=(0,e.inject)(j.Router),n=I.getCurrentUser();return n?!!o.includes(n.role)||(console.warn(`[RoleGuard] User role ${n.role} not allowed, redirecting to home`),t.navigate(["/"]),!1):(console.warn("[RoleGuard] No user found, redirecting to home"),t.navigate(["/"]),!1)}}const Q=S([d.g.SUPER_ADMIN,d.g.ORG_ADMIN,d.g.TEAM_LEAD]),H=(S([d.g.SUPER_ADMIN,d.g.ORG_ADMIN]),S([d.g.SUPER_ADMIN,d.g.ORG_ADMIN,d.g.TEAM_LEAD,d.g.SALES_EXECUTIVE]));var Y=a(1633);const X=[{path:"lazy",component:c},{path:"funny",component:$},{path:"multi-mfe-demo",component:(()=>{class o{constructor(){this.mfeList=["pokemon","my-sales","my-report"]}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-multi-mfe-demo"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:6,vars:2,consts:[[1,"demo-container"],[3,"names","lazyLoad"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"h2"),e.\u0275\u0275text(2,"Multiple MFE Demo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p"),e.\u0275\u0275text(4,"This page demonstrates loading multiple MFEs with lazy loading enabled."),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"app-mfe-wrapper",1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("names",i.mfeList)("lazyLoad",!0))},dependencies:[Y.n],styles:[".demo-container[_ngcontent-%COMP%]{padding:2rem}.demo-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#333}.demo-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:2rem;color:#666}"]})}}return o})()},{path:"auth-callback",loadComponent:()=>a.e(472).then(a.bind(a,4472)).then(o=>o.AuthCallbackComponent)},{path:"rules",loadChildren:()=>a.e(654).then(a.bind(a,2654)).then(o=>o.CRUD_RULES_ROUTES),canActivate:[Q]},{path:"sales",loadChildren:()=>a.e(654).then(a.bind(a,2654)).then(o=>o.MY_SALES_ROUTES),canActivate:[H]},{path:"reports",loadChildren:()=>a.e(654).then(a.bind(a,2654)).then(o=>o.MY_REPORT_ROUTES),canActivate:[H]},{path:"**",redirectTo:"",pathMatch:"full"}],Z=(o,I)=>new h.Observable(t=>{let n;return(0,r.A)(function*(){const{urlWithParams:f}=o,M=yield caches.open("http"),E=yield M.match(f);if(E){let p;console.log("Serve from Cache for",f);try{p=yield E.clone().json()}catch{p=yield E.clone().text()}return t.next(new C.HttpResponse({body:p,status:E.status||200,url:o.urlWithParams})),void t.complete()}var p;n=I(o).subscribe({next:(p=(0,r.A)(function*(y){if(console.log("Cache miss for ",f),t.next(y),y instanceof C.HttpResponse&&y.ok){const W=new Response(JSON.stringify(y.body),{headers:{"Content-Type":"application/json"},status:y.status,statusText:y.statusText});yield M.put(o.urlWithParams,W)}}),function(W){return p.apply(this,arguments)}),error:p=>t.error(p),complete:()=>t.complete()})})(),()=>n?.unsubscribe()});function q(){return(0,A.bootstrapApplication)(V,{providers:[(0,j.provideRouter)(X),(0,C.provideHttpClient)((0,C.withFetch)(),(0,C.withInterceptors)([Z]))]})}}}]);