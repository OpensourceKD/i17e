(self.webpackChunkshell=self.webpackChunkshell||[]).push([[130],{3540:(L,R,s)=>{s.d(R,{MfeLoaderService:()=>e});var O=s(467),x=s(2485),S=s(1913),d=s(5565);let e=(()=>{class v{constructor(){this.mfeConfigs=[],this.loadedMfesSubject=new x.BehaviorSubject(new Set),this.loadedMfes$=this.loadedMfesSubject.asObservable(),this.loadingMfesSubject=new x.BehaviorSubject(new Set),this.loadingMfes$=this.loadingMfesSubject.asObservable()}setConfigs(l){this.mfeConfigs=l.sort((a,E)=>E.priority-a.priority)}getConfigs(){return this.mfeConfigs}getConfigsForRole(l){return this.mfeConfigs.filter(a=>a.allowedRoles.includes(l))}getConfigByName(l){return this.mfeConfigs.find(a=>a.name===l)}preloadPriorityMfes(l){var a=this;return(0,O.A)(function*(){const b=a.getConfigsForRole(l).filter(g=>g.priority>=5).map(g=>a.loadMfe(g));yield Promise.all(b)})()}loadMfe(l){var a=this;return(0,O.A)(function*(){const E=a.loadingMfesSubject.value,j=a.loadedMfesSubject.value;if(j.has(l.name))console.log(`[MfeLoaderService] MFE ${l.name} already loaded`);else if(E.has(l.name))console.log(`[MfeLoaderService] MFE ${l.name} is already loading`);else try{const b=new Set(E);b.add(l.name),a.loadingMfesSubject.next(b),console.log(`[MfeLoaderService] Loading MFE ${l.name} (priority: ${l.priority})`);const g=yield(0,S.loadRemoteModule)({type:"module",remoteEntry:l.url,exposedModule:l.exposedModule}),A=new Set(j);A.add(l.name),a.loadedMfesSubject.next(A);const P=new Set(a.loadingMfesSubject.value);return P.delete(l.name),a.loadingMfesSubject.next(P),console.log(`[MfeLoaderService] Successfully loaded MFE ${l.name}`),g}catch(b){console.error(`[MfeLoaderService] Error loading MFE ${l.name}:`,b);const g=new Set(a.loadingMfesSubject.value);throw g.delete(l.name),a.loadingMfesSubject.next(g),b}})()}isMfeLoaded(l){return this.loadedMfesSubject.value.has(l)}isMfeLoading(l){return this.loadingMfesSubject.value.has(l)}static{this.\u0275fac=function(a){return new(a||v)}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})()},3130:(L,R,s)=>{s.r(R),s.d(R,{bootstrap:()=>Z});var O=s(1194),x=s(467),M=s(3319),S=s(5315),C=s(3793),d=s(2485),k=s(7412),e=s(5565),v=s(1663);let T=(()=>{class r{constructor(t){this.http=t}login(){window.location.href="http://localhost:4000/auth/login"}logout(){window.location.href="http://localhost:4000/auth/logout"}getUserProfile(){return this.http.get("http://localhost:4000/auth/me",{withCredentials:!0})}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275inject(v.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var l=s(8662),a=s(9903);let E=(()=>{class r{constructor(){this.currentUserSubject=new d.BehaviorSubject(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadDummyUser()}loadDummyUser(){const t=sessionStorage.getItem("current_user");t?this.currentUserSubject.next(JSON.parse(t)):this.setCurrentUser({id:"1",name:"John Doe",email:"john.doe@example.com",role:a.g.SALES_EXECUTIVE})}setCurrentUser(t){this.currentUserSubject.next(t),t?sessionStorage.setItem("current_user",JSON.stringify(t)):sessionStorage.removeItem("current_user")}getCurrentUser(){return this.currentUserSubject.value}getCurrentUserRole(){return this.currentUserSubject.value?.role||null}hasRole(t){const n=this.getCurrentUserRole();return!!n&&(0,a.W)(n,t)}canViewOthersData(){const t=this.getCurrentUserRole();return t===a.g.SUPER_ADMIN||t===a.g.ORG_ADMIN||t===a.g.TEAM_LEAD}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),j=(()=>{class r{constructor(){this.salesExecutivesSubject=new d.BehaviorSubject(this.generateSalesExecutives()),this.salesExecutives$=this.salesExecutivesSubject.asObservable(),this.salesRecordsSubject=new d.BehaviorSubject(this.generateSalesRecords()),this.salesRecords$=this.salesRecordsSubject.asObservable(),this.incentiveRulesSubject=new d.BehaviorSubject(this.generateIncentiveRules()),this.incentiveRules$=this.incentiveRulesSubject.asObservable(),this.incentivesEarnedSubject=new d.BehaviorSubject(this.generateIncentivesEarned()),this.incentivesEarned$=this.incentivesEarnedSubject.asObservable()}generateSalesExecutives(){return[{id:"1",name:"John Doe",email:"john.doe@example.com",teamId:"team1"},{id:"2",name:"Jane Smith",email:"jane.smith@example.com",teamId:"team1"},{id:"3",name:"Bob Johnson",email:"bob.johnson@example.com",teamId:"team2"},{id:"4",name:"Alice Williams",email:"alice.williams@example.com",teamId:"team2"},{id:"5",name:"Charlie Brown",email:"charlie.brown@example.com",teamId:"team1"}]}generateSalesRecords(){const t=[],n=this.generateSalesExecutives(),o=["Product A","Product B","Product C","Product D"],c=["completed","pending","cancelled"];for(let i=0;i<50;i++){const h=n[i%n.length],p=Math.floor(i/10),u=new Date;u.setMonth(u.getMonth()-p),t.push({id:`sale-${i+1}`,salesExecutiveId:h.id,salesExecutiveName:h.name,date:u,productName:o[i%o.length],amount:Math.floor(5e4*Math.random())+1e4,quantity:Math.floor(10*Math.random())+1,status:c[i%3]})}return t}generateIncentiveRules(){return[{id:"rule-1",name:"Basic Sales Incentive",description:"5% incentive on all sales",type:"percentage",value:5,isActive:!0,createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"rule-2",name:"High Value Sales Bonus",description:"10% incentive on sales above $50,000",type:"percentage",value:10,minSalesAmount:5e4,isActive:!0,createdBy:"admin",createdAt:new Date("2024-02-01")},{id:"rule-3",name:"Product A Special",description:"Fixed $500 bonus for Product A sales",type:"fixed",value:500,productCategory:"Product A",isActive:!0,createdBy:"team-lead-1",createdAt:new Date("2024-03-01")},{id:"rule-4",name:"Tiered Volume Incentive",description:"15% incentive on sales above $100,000",type:"tiered",value:15,minSalesAmount:1e5,isActive:!1,createdBy:"admin",createdAt:new Date("2024-04-01")}]}generateIncentivesEarned(){const t=[],n=this.generateSalesExecutives(),o=this.generateIncentiveRules(),c=["pending","approved","paid"];for(let i=0;i<30;i++){const h=n[i%n.length],p=o[i%o.length],u=Math.floor(i/10),m=new Date;m.setMonth(m.getMonth()-u),t.push({id:`incentive-${i+1}`,salesExecutiveId:h.id,salesExecutiveName:h.name,ruleId:p.id,ruleName:p.name,salesRecordId:`sale-${i+1}`,amount:Math.floor(5e3*Math.random())+500,earnedDate:m,status:c[i%3]})}return t}getSalesRecordsForExecutive(t){return this.salesRecordsSubject.value.filter(n=>n.salesExecutiveId===t)}getIncentivesForExecutive(t){return this.incentivesEarnedSubject.value.filter(n=>n.salesExecutiveId===t)}getReportDataForExecutive(t){const n=this.salesExecutivesSubject.value.find(u=>u.id===t),o=this.getSalesRecordsForExecutive(t),c=this.getIncentivesForExecutive(t),i=o.filter(u=>"completed"===u.status).reduce((u,m)=>u+m.amount,0),h=c.filter(u=>"pending"!==u.status).reduce((u,m)=>u+m.amount,0),p=[];for(let u=5;u>=0;u--){const m=new Date;m.setMonth(m.getMonth()-u);const I=m.toISOString().substring(0,7),Q=o.filter(y=>y.date.toISOString().substring(0,7)===I&&"completed"===y.status).reduce((y,D)=>y+D.amount,0),q=c.filter(y=>y.earnedDate.toISOString().substring(0,7)===I&&"pending"!==y.status).reduce((y,D)=>y+D.amount,0);p.push({month:I,sales:Q,incentives:q})}return{salesExecutiveId:t,salesExecutiveName:n?.name||"Unknown",totalSales:i,totalIncentives:h,period:"Last 6 months",breakdown:p}}getSalesExecutives(){return this.salesExecutivesSubject.value}getIncentiveRules(){return this.incentiveRulesSubject.value}addIncentiveRule(t){this.incentiveRulesSubject.next([...this.incentiveRulesSubject.value,t])}updateIncentiveRule(t,n){const c=this.incentiveRulesSubject.value.map(i=>i.id===t?{...i,...n}:i);this.incentiveRulesSubject.next(c)}deleteIncentiveRule(t){const o=this.incentiveRulesSubject.value.filter(c=>c.id!==t);this.incentiveRulesSubject.next(o)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var b=s(3540);function g(r,f){if(1&r&&(e.\u0275\u0275elementStart(0,"option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=f.$implicit;e.\u0275\u0275property("value",t.id),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(t.name)}}function A(r,f){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",10)(1,"div",11)(2,"label",12),e.\u0275\u0275text(3,"View data for:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",13),e.\u0275\u0275text(5," Selecting a user will display their incentive data. "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"select",14),e.\u0275\u0275twoWayListener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const c=e.\u0275\u0275nextContext();return e.\u0275\u0275twoWayBindingSet(c.selectedSalesExecutiveId,o)||(c.selectedSalesExecutiveId=o),e.\u0275\u0275resetView(o)}),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onSalesExecutiveChange())}),e.\u0275\u0275elementStart(7,"option",15),e.\u0275\u0275text(8,"My Data"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,g,2,2,"option",16),e.\u0275\u0275elementEnd()()()}if(2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275twoWayProperty("ngModel",t.selectedSalesExecutiveId),e.\u0275\u0275advance(),e.\u0275\u0275property("value",t.currentUser.id),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.salesExecutives)}}function P(r,f){if(1&r&&(e.\u0275\u0275elementStart(0,"span",17),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate2(" ",t.currentUser.name," (",t.currentUser.role,") ")}}function F(r,f){if(1&r&&(e.\u0275\u0275elementStart(0,"a",21),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=f.$implicit;e.\u0275\u0275property("routerLink","/"+t.route),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function _(r,f){if(1&r&&(e.\u0275\u0275elementStart(0,"nav",18),e.\u0275\u0275template(1,F,2,2,"a",19),e.\u0275\u0275elementStart(2,"a",20),e.\u0275\u0275text(3,"Lazy Demo"),e.\u0275\u0275elementEnd()()),2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",t.availableMfes)}}let B=(()=>{class r{constructor(t,n,o,c,i,h,p){this.auth2=t,this.auth=n,this.route=o,this.router=c,this.roleService=i,this.dummyDataService=h,this.mfeLoader=p,this.title="Incentive Management System",this.currentUser=null,this.availableMfes=[],this.salesExecutives=[],this.selectedSalesExecutiveId="",this.canViewOthers=!1,this.user=null,this.mfe1="pokemon",this.isAuthenticated=!1,this.userInfo=null,this.message="Processing authentication...",this.isProcessing=!0,this.mfeLoader.setConfigs(k.R)}ngOnInit(){var t=this;return(0,x.A)(function*(){t.roleService.currentUser$.subscribe(h=>{t.currentUser=h,h&&(t.selectedSalesExecutiveId=h.id,t.canViewOthers=t.roleService.canViewOthersData(),t.updateAvailableMfes(),t.loadSalesExecutives(),t.preloadMfes())});let n=null,o=null,c=null;const i=yield(0,d.firstValueFrom)(t.route.queryParams);if(i&&Object.keys(i).length>0)n=i.code??null,o=i.state??null,c=i.error??null;else{const h=new URLSearchParams(window.location.search);n=h.get("code"),o=h.get("state"),c=h.get("error")}if(c)return t.message=`Authentication failed: ${c}`,t.isProcessing=!1,void setTimeout(()=>t.router.navigate(["/"]),3e3);if(n&&o)try{(yield t.auth.handleCallback(n,o))?(t.message="Authentication successful! Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),1500)):(t.message="Authentication failed. Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3))}catch{t.message="Authentication failed (exception). Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3)}else t.message="Invalid callback parameters. Redirecting...",t.isProcessing=!1,setTimeout(()=>t.router.navigate(["/"]),3e3)})()}updateAvailableMfes(){this.availableMfes=this.currentUser?this.mfeLoader.getConfigsForRole(this.currentUser.role):[]}loadSalesExecutives(){this.canViewOthers&&(this.salesExecutives=this.dummyDataService.getSalesExecutives())}preloadMfes(){var t=this;return(0,x.A)(function*(){if(t.currentUser)try{yield t.mfeLoader.preloadPriorityMfes(t.currentUser.role)}catch(n){console.error("[AppComponent] Error preloading MFEs:",n)}})()}onSalesExecutiveChange(){sessionStorage.setItem("selected_sales_executive_id",this.selectedSalesExecutiveId),window.dispatchEvent(new CustomEvent("salesExecutiveChanged",{detail:{salesExecutiveId:this.selectedSalesExecutiveId}}))}login(){this.auth.login()}logout(){this.auth.logout(),this.roleService.setCurrentUser(null)}fetchUser(){}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275directiveInject(T),e.\u0275\u0275directiveInject(l.AuthService),e.\u0275\u0275directiveInject(M.ActivatedRoute),e.\u0275\u0275directiveInject(M.Router),e.\u0275\u0275directiveInject(E),e.\u0275\u0275directiveInject(j),e.\u0275\u0275directiveInject(b.MfeLoaderService))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-root"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:13,vars:3,consts:[[1,"app-container"],[1,"app-header"],[1,"header-left"],[1,"app-title"],["class","header-center",4,"ngIf"],[1,"header-right"],["class","user-info",4,"ngIf"],[1,"btn-logout",3,"click"],["class","app-nav",4,"ngIf"],[1,"app-content"],[1,"header-center"],[1,"user-selector"],["for","salesExecSelect"],["id","salesExecSelectDesc",1,"visually-hidden"],["id","salesExecSelect","aria-describedby","salesExecSelectDesc",3,"ngModelChange","change","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"user-info"],[1,"app-nav"],["routerLinkActive","active","class","nav-link",3,"routerLink",4,"ngFor","ngForOf"],["routerLink","/lazy","routerLinkActive","active",1,"nav-link"],["routerLinkActive","active",1,"nav-link",3,"routerLink"]],template:function(n,o){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),e.\u0275\u0275text(4,"Incentive Management System"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(5,A,10,3,"div",4),e.\u0275\u0275elementStart(6,"div",5),e.\u0275\u0275template(7,P,2,2,"span",6),e.\u0275\u0275elementStart(8,"button",7),e.\u0275\u0275listener("click",function(){return o.logout()}),e.\u0275\u0275text(9,"Logout"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(10,_,4,1,"nav",8),e.\u0275\u0275elementStart(11,"main",9),e.\u0275\u0275element(12,"router-outlet"),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",o.currentUser&&o.canViewOthers),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.currentUser),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",o.currentUser))},dependencies:[M.RouterOutlet,S.CommonModule,S.NgForOf,S.NgIf,M.RouterLink,M.RouterLinkActive,C.FormsModule,C.NgSelectOption,C.\u0275NgSelectMultipleOption,C.SelectControlValueAccessor,C.NgControlStatus,C.NgModel],styles:['[_nghost-%COMP%]{--bright-blue: oklch(51.01% .274 263.83);--electric-violet: oklch(53.18% .28 296.97);--french-violet: oklch(47.66% .246 305.88);--vivid-pink: oklch(69.02% .277 332.77);--hot-red: oklch(61.42% .238 15.34);--orange-red: oklch(63.32% .24 31.68);--gray-900: oklch(19.37% .006 300.98);--gray-700: oklch(36.98% .014 302.71);--gray-400: oklch(70.9% .015 304.04);--red-to-pink-to-purple-vertical-gradient: linear-gradient( 180deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--red-to-pink-to-purple-horizontal-gradient: linear-gradient( 90deg, var(--orange-red) 0%, var(--vivid-pink) 50%, var(--electric-violet) 100% );--pill-accent: var(--bright-blue);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.app-header[_ngcontent-%COMP%]{background:#fff;padding:1rem 2rem;border-bottom:2px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px #0000001a}.header-left[_ngcontent-%COMP%]{flex:1}.app-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:var(--gray-900);font-weight:600}.header-center[_ngcontent-%COMP%]{flex:2;display:flex;justify-content:center}.user-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.user-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--gray-700);font-weight:500}.user-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid var(--gray-400);border-radius:.375rem;font-size:.875rem;background:#fff;cursor:pointer;min-width:200px}.header-right[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:flex-end;align-items:center;gap:1rem}.user-info[_ngcontent-%COMP%]{color:var(--gray-700);font-size:.875rem;font-weight:500}.btn-logout[_ngcontent-%COMP%]{background:var(--hot-red);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.375rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-logout[_ngcontent-%COMP%]:hover{background:var(--orange-red)}.app-nav[_ngcontent-%COMP%]{background:var(--gray-900);padding:0;display:flex;gap:0}.nav-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;padding:1rem 1.5rem;font-size:.875rem;font-weight:500;transition:background .2s ease;border-bottom:3px solid transparent}.nav-link[_ngcontent-%COMP%]:hover{background:var(--gray-700)}.nav-link.active[_ngcontent-%COMP%]{background:var(--bright-blue);border-bottom-color:var(--electric-violet)}.app-content[_ngcontent-%COMP%]{flex:1;padding:2rem;background:#f5f5f5}.auth-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:#fff;padding:1rem 2rem;border-bottom:1px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 2px 4px #0000001a}.auth-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-name[_ngcontent-%COMP%]{color:var(--gray-900);font-weight:500}.auth-button[_ngcontent-%COMP%]{background:var(--bright-blue);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .3s ease}.auth-button[_ngcontent-%COMP%]:hover{background:var(--electric-violet)}.logout-button[_ngcontent-%COMP%]{background:var(--hot-red)}.logout-button[_ngcontent-%COMP%]:hover{background:var(--orange-red)}']})}}return r})();var U=s(8049);let N=(()=>{class r{constructor(t){this.$http=t,this.$masterSet=new d.BehaviorSubject([]),this.$loadMoreEvent=new d.BehaviorSubject(""),this.url="https://pokeapi.co/api/v2/pokemon/?offset=0&limit=20",this.$http.get(this.url).pipe((0,d.tap)(({next:n})=>{this.next=n}),(0,d.map)(({results:n})=>n)).subscribe(n=>this.$masterSet.next(n)),this.$loadMoreEvent.pipe((0,d.debounceTime)(500)).subscribe(n=>{"loadMore"===n&&this.loadMore()})}loadMore(){this.next&&this.$http.get(this.next).pipe((0,d.tap)(({next:t})=>{this.next=t}),(0,d.map)(({results:t})=>t)).subscribe(t=>{this.$masterSet.next([...this.$masterSet.value,...t])})}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275inject(v.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),$=(()=>{class r{constructor(t){this.zone=t}start(t){this.eventSource=new EventSource(t);const n=this.eventSource;return new d.Observable(o=>{const c=(0,d.fromEvent)(n,"message").subscribe(i=>{this.zone.run(()=>o.next(i.data))});return n.onerror=i=>{this.zone.run(()=>o.error(i))},()=>{c.unsubscribe(),n.close()}})}stop(){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0)}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275inject(e.NgZone))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function z(r,f){if(1&r&&(e.\u0275\u0275elementStart(0,"li"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const t=f.$implicit;e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(t.name)}}let V=(()=>{class r{constructor(t,n,o){this.pokemonService=t,this.destroyRef=n,this.sseService=o,this.messages=[],(0,d.fromEvent)(window,"scroll").pipe((0,U.takeUntilDestroyed)(this.destroyRef),(0,d.map)(()=>window.scrollY+window.innerHeight>=document.body.scrollHeight),(0,d.distinctUntilChanged)(),(0,d.filter)(c=>!0===c)).subscribe(()=>{this.pokemonService.$loadMoreEvent.next("loadMore")}),console.log("LazyloadComponent constructed")}referId(t,n){return n.name}ngOnInit(){}start(){this.sseService.start("https://stream.wikimedia.org/v2/stream/recentchange").pipe((0,U.takeUntilDestroyed)(this.destroyRef)).subscribe({next:t=>{console.log("SSE:",t),this.messages.push(t)},error:t=>console.error("SSE error",t)})}stop(){console.log("SSE stopped"),this.sseService.stop()}ngOnDestroy(){console.log("LazyloadComponent destroyed")}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275directiveInject(N),e.\u0275\u0275directiveInject(e.DestroyRef),e.\u0275\u0275directiveInject($))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-lazyload"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:9,vars:4,consts:[[1,"px-4","py-2","bg-green-500","text-white","rounded","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(n,o){1&n&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1,"lazyload works!"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",0),e.\u0275\u0275listener("click",function(){return o.start()}),e.\u0275\u0275text(3,"Start"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",1),e.\u0275\u0275listener("click",function(){return o.stop()}),e.\u0275\u0275text(5,"Stop"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"ul"),e.\u0275\u0275template(7,z,2,1,"li",2),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(8,2,o.pokemonService.$masterSet))("ngForTrackBy",o.referId))},dependencies:[S.CommonModule,S.NgForOf,S.AsyncPipe]})}}return r})();var W=s(762),G=s.n(W);let J=(()=>{class r{constructor(){this.emitter=G()();const t=new Event("EventBusServiceCreated");this.onePlusNEvents=new d.ReplaySubject(100),this.onePlusNEvents.next(t.type),this.emitter.on("*",n=>this.onePlusNEvents.next(n))}sendEvent(t){this.emitter.emit(t)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),H=(()=>{class r{constructor(t,n){this.eventBus=t,this.destroyRef=n,this.eventBus.onePlusNEvents.pipe((0,U.takeUntilDestroyed)(this.destroyRef),(0,d.filter)(o=>"JOJO"===o)).subscribe(this.catchJojo)}catchJojo(t){console.log("PUTIN!!")}static{this.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275directiveInject(J),e.\u0275\u0275directiveInject(e.DestroyRef))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-funny"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(n,o){1&n&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1,"funny works!"),e.\u0275\u0275elementEnd())}})}}return r})();function w(r){return()=>{const f=(0,e.inject)(E),t=(0,e.inject)(M.Router),n=f.getCurrentUser();return n?!!r.includes(n.role)||(console.warn(`[RoleGuard] User role ${n.role} not allowed, redirecting to home`),t.navigate(["/"]),!1):(console.warn("[RoleGuard] No user found, redirecting to home"),t.navigate(["/"]),!1)}}const K=w([a.g.SUPER_ADMIN,a.g.ORG_ADMIN,a.g.TEAM_LEAD]),X=(w([a.g.SUPER_ADMIN,a.g.ORG_ADMIN]),[{path:"lazy",component:V},{path:"funny",component:H},{path:"auth-callback",loadComponent:()=>s.e(472).then(s.bind(s,4472)).then(r=>r.AuthCallbackComponent)},{path:"rules",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(r=>r.CRUD_RULES_ROUTES),canActivate:[K]},{path:"sales",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(r=>r.MY_SALES_ROUTES),canActivate:[w([a.g.SUPER_ADMIN,a.g.ORG_ADMIN,a.g.TEAM_LEAD,a.g.SALES_EXECUTIVE])]},{path:"reports",loadChildren:()=>s.e(430).then(s.bind(s,9430)).then(r=>r.MY_REPORT_ROUTES),canActivate:[w([a.g.SUPER_ADMIN,a.g.ORG_ADMIN,a.g.TEAM_LEAD,a.g.SALES_EXECUTIVE])]},{path:"**",redirectTo:"",pathMatch:"full"}]),Y=(r,f)=>new d.Observable(t=>{let n;return(0,x.A)(function*(){const{urlWithParams:c}=r,h=yield caches.open("http"),p=yield h.match(c);if(p){let u;console.log("Serve from Cache for",c);try{u=yield p.clone().json()}catch{u=yield p.clone().text()}return t.next(new v.HttpResponse({body:u,status:p.status||200,url:r.urlWithParams})),void t.complete()}var u;n=f(r).subscribe({next:(u=(0,x.A)(function*(m){if(console.log("Cache miss for ",c),t.next(m),m instanceof v.HttpResponse&&m.ok){const I=new Response(JSON.stringify(m.body),{headers:{"Content-Type":"application/json"},status:m.status,statusText:m.statusText});yield h.put(r.urlWithParams,I)}}),function(I){return u.apply(this,arguments)}),error:u=>t.error(u),complete:()=>t.complete()})})(),()=>n?.unsubscribe()});function Z(){return(0,O.bootstrapApplication)(B,{providers:[(0,M.provideRouter)(X),(0,v.provideHttpClient)((0,v.withFetch)(),(0,v.withInterceptors)([Y]))]})}}}]);